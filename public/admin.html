<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê´€ë¦¬ì í˜ì´ì§€ - ë§ˆì‚¬ì§€ê°€ê°€</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .admin-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .admin-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .header-left {
        flex: 1;
      }

      .header-left h1 {
        margin: 0 0 10px 0;
      }

      .header-left p {
        margin: 0;
        opacity: 0.9;
      }

      .header-right {
        display: flex;
        gap: 15px;
        align-items: center;
      }

      .user-info {
        text-align: right;
      }

      .user-name {
        font-weight: 600;
        font-size: 16px;
      }

      .user-role {
        font-size: 12px;
        opacity: 0.8;
      }

      .btn-logout {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 2px solid white;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
      }

      .btn-logout:hover {
        background: white;
        color: #667eea;
      }

      .admin-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .tab-btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        background: #f8f9fa;
        cursor: pointer;
        transition: all 0.3s;
      }

      .tab-btn.active {
        background: #667eea;
        color: white;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .form-section {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #333;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        font-size: 14px;
        transition: border-color 0.3s;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #667eea;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .btn-primary {
        background: #667eea;
        color: white;
      }

      .btn-primary:hover {
        background: #5a6fd8;
      }

      .btn-success {
        background: #28a745;
        color: white;
      }

      .btn-danger {
        background: #dc3545;
        color: white;
      }

      .course-item {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 15px;
        border: 1px solid #e9ecef;
      }

      .course-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .remove-btn {
        background: #dc3545;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
      }

      .shops-list {
        display: grid;
        gap: 20px;
      }

      .shop-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid #e9ecef;
      }

      .shop-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
      }

      .shop-actions {
        display: flex;
        gap: 10px;
      }

      .status-badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
      }

      .status-active {
        background: #d4edda;
        color: #155724;
      }

      .status-inactive {
        background: #f8d7da;
        color: #721c24;
      }

      .image-preview-container {
        margin-top: 10px;
        display: none;
      }

      .image-preview-container.show {
        display: block;
      }

      .preview-image {
        width: 200px;
        height: 150px;
        border-radius: 8px;
        object-fit: cover;
        border: 2px solid #e9ecef;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .btn-insert-image {
        background: #28a745;
        color: white;
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        margin-top: 10px;
        display: inline-flex;
        align-items: center;
        gap: 5px;
      }

      .btn-insert-image:hover {
        background: #218838;
      }
    </style>
  </head>
  <body>
    <div class="admin-container">
      <div class="admin-header">
        <div class="header-left">
          <h1><i class="fas fa-tachometer-alt"></i> ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
          <p>ë§ˆì‚¬ì§€ê°€ê°€ ì—…ì²´ ë° íšŒì› ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
        </div>
        <div class="header-right">
          <div class="user-info">
            <div class="user-name" id="currentUserName">ê´€ë¦¬ì</div>
            <div class="user-role" id="currentUserRole">Administrator</div>
          </div>
          <button class="btn-logout" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> ë¡œê·¸ì•„ì›ƒ
          </button>
        </div>
      </div>

      <div class="admin-tabs">
        <button class="tab-btn active" onclick="showTab('add')">
          <i class="fas fa-plus-circle"></i> ì—…ì²´ ë“±ë¡
        </button>
        <button class="tab-btn" onclick="showTab('list')">
          <i class="fas fa-list"></i> ì—…ì²´ ëª©ë¡
        </button>
        <button class="tab-btn" onclick="showTab('stats')">
          <i class="fas fa-chart-bar"></i> í†µê³„
        </button>
        <button
          class="tab-btn"
          onclick="window.location.href='users-management.html'"
        >
          <i class="fas fa-users"></i> íšŒì› ê´€ë¦¬
        </button>
        <button class="tab-btn" onclick="window.location.href='index.html'">
          <i class="fas fa-home"></i> í™ˆìœ¼ë¡œ
        </button>
      </div>

      <!-- ì—…ì²´ ë“±ë¡ íƒ­ -->
      <div id="add-tab" class="tab-content active">
        <form id="shopForm" class="form-section">
          <h2>ìƒˆ ì—…ì²´ ë“±ë¡</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="name">ì—…ì²´ëª… *</label>
              <input type="text" id="name" name="name" required />
            </div>
            <div class="form-group">
              <label for="type">ì—…ì²´ ìœ í˜• *</label>
              <select id="type" name="type" required>
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="korean">í•œêµ­ ë§ˆì‚¬ì§€</option>
                <option value="thai">íƒœêµ­ ë§ˆì‚¬ì§€</option>
                <option value="foot">ë°œë§ˆì‚¬ì§€</option>
                <option value="spa">ìŠ¤íŒŒ</option>
                <option value="outcall">ì¶œì¥ë§ˆì‚¬ì§€</option>
                <option value="waxing">ì™ì‹±</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="region">ì§€ì—­ *</label>
              <select
                id="region"
                name="region"
                required
                onchange="updateDistricts()"
              >
                <option value="">ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="ì„œìš¸">ì„œìš¸</option>
                <option value="ë¶€ì‚°">ë¶€ì‚°</option>
                <option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
                <option value="ì¸ì²œ">ì¸ì²œ</option>
                <option value="ê´‘ì£¼">ê´‘ì£¼</option>
                <option value="ëŒ€ì „">ëŒ€ì „</option>
                <option value="ìš¸ì‚°">ìš¸ì‚°</option>
                <option value="ì„¸ì¢…">ì„¸ì¢…</option>
                <option value="ê²½ê¸°">ê²½ê¸°</option>
                <option value="ê°•ì›">ê°•ì›</option>
                <option value="ì¶©ë¶">ì¶©ë¶</option>
                <option value="ì¶©ë‚¨">ì¶©ë‚¨</option>
                <option value="ì „ë¶">ì „ë¶</option>
                <option value="ì „ë‚¨">ì „ë‚¨</option>
                <option value="ê²½ë¶">ê²½ë¶</option>
                <option value="ê²½ë‚¨">ê²½ë‚¨</option>
                <option value="ì œì£¼">ì œì£¼</option>
              </select>
            </div>
            <div class="form-group">
              <label for="district">êµ¬/ì‹œ *</label>
              <select
                id="district"
                name="district"
                required
                style="opacity: 0.5"
              >
                <option value="">ë¨¼ì € ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="address">ì£¼ì†Œ *</label>
            <input type="text" id="address" name="address" required />
          </div>

          <div class="form-group">
            <label for="detailAddress">ìƒì„¸ì£¼ì†Œ</label>
            <input type="text" id="detailAddress" name="detailAddress" />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="phone">ì „í™”ë²ˆí˜¸ *</label>
              <input type="text" id="phone" name="phone" required />
            </div>
            <div class="form-group">
              <label for="price">ìµœì €ê°€ *</label>
              <input
                type="text"
                id="price"
                name="price"
                placeholder="ì˜ˆ: 80,000ì›~"
                required
              />
            </div>
          </div>

          <div class="form-group">
            <label for="operatingHours">ìš´ì˜ì‹œê°„</label>
            <input
              type="text"
              id="operatingHours"
              name="operatingHours"
              placeholder="ì˜ˆ: 10:00 - 22:00"
            />
          </div>

          <div class="form-group">
            <label for="description">ì—…ì²´ ì„¤ëª…</label>
            <textarea id="description" name="description" rows="3"></textarea>
          </div>

          <div class="form-group">
            <label for="image">ì´ë¯¸ì§€ URL</label>
            <input
              type="url"
              id="image"
              name="image"
              placeholder="https://i.imgur.com/yourimage.jpg"
            />
            <button
              type="button"
              class="btn-insert-image"
              onclick="previewImage()"
            >
              <i class="fas fa-eye"></i> ë¯¸ë¦¬ë³´ê¸°
            </button>
            <div id="imagePreviewContainer" class="image-preview-container">
              <img
                id="previewImage"
                class="preview-image"
                alt="ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°"
              />
            </div>
          </div>

          <div class="form-group">
            <label for="services">ì„œë¹„ìŠ¤ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
            <input
              type="text"
              id="services"
              name="services"
              placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ, ì•„ë¡œë§ˆ, ë°œë§ˆì‚¬ì§€"
            />
          </div>

          <div class="form-group">
            <label for="features">íŠ¹ì§• (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
            <input
              type="text"
              id="features"
              name="features"
              placeholder="ì˜ˆ: ì£¼ì°¨ ê°€ëŠ¥, ê°œì¸ì‹¤, 24ì‹œê°„"
            />
          </div>

          <div class="form-group">
            <label for="tags">íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
            <input
              type="text"
              id="tags"
              name="tags"
              placeholder="ì˜ˆ: ê°•ë‚¨êµ¬, ìŠ¤ì›¨ë””ì‹œ, ì•„ë¡œë§ˆ"
            />
          </div>

          <div class="form-group">
            <label for="coordinates">ì¢Œí‘œ (ìœ„ë„, ê²½ë„)</label>
            <div class="form-row">
              <input
                type="number"
                id="latitude"
                name="latitude"
                step="any"
                placeholder="ìœ„ë„"
              />
              <input
                type="number"
                id="longitude"
                name="longitude"
                step="any"
                placeholder="ê²½ë„"
              />
            </div>
          </div>

          <!-- ì½”ìŠ¤ ì„¹ì…˜ -->
          <div class="form-group">
            <label>ì½”ìŠ¤ ì •ë³´</label>
            <div id="coursesContainer">
              <div class="course-item">
                <div class="course-header">
                  <h4>ì½”ìŠ¤ 1</h4>
                  <button
                    type="button"
                    class="remove-btn"
                    onclick="removeCourse(this)"
                  >
                    ì‚­ì œ
                  </button>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>ì¹´í…Œê³ ë¦¬</label>
                    <input
                      type="text"
                      name="courseCategory"
                      placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ í”„ë¡œê·¸ë¨"
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>ì½”ìŠ¤ëª…</label>
                    <input
                      type="text"
                      name="courseName"
                      placeholder="ì˜ˆ: Aì½”ìŠ¤"
                    />
                  </div>
                  <div class="form-group">
                    <label>ê°€ê²©</label>
                    <input
                      type="text"
                      name="coursePrice"
                      placeholder="ì˜ˆ: 80,000ì›"
                    />
                  </div>
                  <div class="form-group">
                    <label>ì‹œê°„</label>
                    <input
                      type="text"
                      name="courseDuration"
                      placeholder="ì˜ˆ: 60ë¶„"
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label>ì„¤ëª…</label>
                  <input
                    type="text"
                    name="courseDescription"
                    placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ + ì•„ë¡œë§ˆ"
                  />
                </div>
              </div>
            </div>
            <button type="button" class="btn btn-primary" onclick="addCourse()">
              ì½”ìŠ¤ ì¶”ê°€
            </button>
          </div>

          <div class="form-group">
            <label for="staffInfo">ê´€ë¦¬ì‚¬ ì •ë³´</label>
            <textarea
              id="staffInfo"
              name="staffInfo"
              rows="2"
              placeholder="ì˜ˆ: ì†Œìœ¨(24), ì œë‹ˆ(20), ì—°ìš°(25)"
            ></textarea>
          </div>

          <button type="submit" class="btn btn-success">ì—…ì²´ ë“±ë¡</button>
        </form>
      </div>

      <!-- ì—…ì²´ ëª©ë¡ íƒ­ -->
      <div id="list-tab" class="tab-content">
        <div class="form-section">
          <h2>ì—…ì²´ ëª©ë¡</h2>
          <div id="shopsList" class="shops-list">
            <!-- ì—…ì²´ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
          </div>
        </div>
      </div>

      <!-- í†µê³„ íƒ­ -->
      <div id="stats-tab" class="tab-content">
        <div class="form-section">
          <h2>í†µê³„ ì •ë³´</h2>
          <div id="statsInfo">
            <!-- í†µê³„ ì •ë³´ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
          </div>
        </div>
      </div>
    </div>

    <script src="api-auth.js"></script>
    <script src="shop-manager.js"></script>
    <script>
      // ê¶Œí•œ í™•ì¸
      if (!authManager.isAdmin()) {
        alert('ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
        window.location.href = 'login.html';
      }

      // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
      const currentUser = authManager.getCurrentUser();
      if (currentUser) {
        document.getElementById('currentUserName').textContent =
          currentUser.name;
        document.getElementById('currentUserRole').textContent =
          currentUser.role === 'admin' ? 'Administrator' : 'User';
      }

      // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
      function logout() {
        if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          authManager.logout();
          window.location.href = 'login.html';
        }
      }

      const shopManager = new ShopManager();
      let courseCount = 1;

      // ì§€ì—­ë³„ êµ¬/ì‹œ ë°ì´í„°
      const districtData = {
        ì„œìš¸: [
          'ê°•ë‚¨êµ¬',
          'ê°•ë™êµ¬',
          'ê°•ë¶êµ¬',
          'ê°•ì„œêµ¬',
          'ê´€ì•…êµ¬',
          'ê´‘ì§„êµ¬',
          'êµ¬ë¡œêµ¬',
          'ê¸ˆì²œêµ¬',
          'ë…¸ì›êµ¬',
          'ë„ë´‰êµ¬',
          'ë™ëŒ€ë¬¸êµ¬',
          'ë™ì‘êµ¬',
          'ë§ˆí¬êµ¬',
          'ì„œëŒ€ë¬¸êµ¬',
          'ì„œì´ˆêµ¬',
          'ì„±ë™êµ¬',
          'ì„±ë¶êµ¬',
          'ì†¡íŒŒêµ¬',
          'ì–‘ì²œêµ¬',
          'ì˜ë“±í¬êµ¬',
          'ìš©ì‚°êµ¬',
          'ì€í‰êµ¬',
          'ì¢…ë¡œêµ¬',
          'ì¤‘êµ¬',
          'ì¤‘ë‘êµ¬',
        ],
        ë¶€ì‚°: [
          'ì¤‘êµ¬',
          'ì„œêµ¬',
          'ë™êµ¬',
          'ì˜ë„êµ¬',
          'ë¶€ì‚°ì§„êµ¬',
          'ë™ë˜êµ¬',
          'ë‚¨êµ¬',
          'ë¶êµ¬',
          'í•´ìš´ëŒ€êµ¬',
          'ì‚¬í•˜êµ¬',
          'ê¸ˆì •êµ¬',
          'ê°•ì„œêµ¬',
          'ì—°ì œêµ¬',
          'ìˆ˜ì˜êµ¬',
          'ì‚¬ìƒêµ¬',
          'ê¸°ì¥êµ°',
        ],
        ëŒ€êµ¬: [
          'ì¤‘êµ¬',
          'ë™êµ¬',
          'ì„œêµ¬',
          'ë‚¨êµ¬',
          'ë¶êµ¬',
          'ìˆ˜ì„±êµ¬',
          'ë‹¬ì„œêµ¬',
          'ë‹¬ì„±êµ°',
        ],
        ì¸ì²œ: [
          'ì¤‘êµ¬',
          'ë™êµ¬',
          'ë¯¸ì¶”í™€êµ¬',
          'ì—°ìˆ˜êµ¬',
          'ë‚¨ë™êµ¬',
          'ë¶€í‰êµ¬',
          'ê³„ì–‘êµ¬',
          'ì„œêµ¬',
          'ê°•í™”êµ°',
          'ì˜¹ì§„êµ°',
        ],
        ê´‘ì£¼: ['ë™êµ¬', 'ì„œêµ¬', 'ë‚¨êµ¬', 'ë¶êµ¬', 'ê´‘ì‚°êµ¬'],
        ëŒ€ì „: ['ë™êµ¬', 'ì¤‘êµ¬', 'ì„œêµ¬', 'ìœ ì„±êµ¬', 'ëŒ€ë•êµ¬'],
        ìš¸ì‚°: ['ì¤‘êµ¬', 'ë‚¨êµ¬', 'ë™êµ¬', 'ë¶êµ¬', 'ìš¸ì£¼êµ°'],
        ì„¸ì¢…: ['ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ'],
        ê²½ê¸°: [
          'ìˆ˜ì›ì‹œ',
          'ì„±ë‚¨ì‹œ',
          'ì˜ì •ë¶€ì‹œ',
          'ì•ˆì–‘ì‹œ',
          'ë¶€ì²œì‹œ',
          'ê´‘ëª…ì‹œ',
          'í‰íƒì‹œ',
          'ê³¼ì²œì‹œ',
          'ì˜¤ì‚°ì‹œ',
          'ì‹œí¥ì‹œ',
          'êµ°í¬ì‹œ',
          'ì˜ì™•ì‹œ',
          'í•˜ë‚¨ì‹œ',
          'ìš©ì¸ì‹œ',
          'íŒŒì£¼ì‹œ',
          'ì´ì²œì‹œ',
          'ì•ˆì„±ì‹œ',
          'ê¹€í¬ì‹œ',
          'í™”ì„±ì‹œ',
          'ê´‘ì£¼ì‹œ',
          'ì—¬ì£¼ì‹œ',
          'ì–‘í‰êµ°',
          'ê³ ì–‘ì‹œ',
          'ë™ë‘ì²œì‹œ',
          'ê°€í‰êµ°',
          'ì—°ì²œêµ°',
        ],
        ê°•ì›: [
          'ì¶˜ì²œì‹œ',
          'ì›ì£¼ì‹œ',
          'ê°•ë¦‰ì‹œ',
          'ë™í•´ì‹œ',
          'íƒœë°±ì‹œ',
          'ì†ì´ˆì‹œ',
          'ì‚¼ì²™ì‹œ',
          'í™ì²œêµ°',
          'íš¡ì„±êµ°',
          'ì˜ì›”êµ°',
          'í‰ì°½êµ°',
          'ì •ì„ êµ°',
          'ì² ì›êµ°',
          'í™”ì²œêµ°',
          'ì–‘êµ¬êµ°',
          'ì¸ì œêµ°',
          'ê³ ì„±êµ°',
          'ì–‘ì–‘êµ°',
        ],
        ì¶©ë¶: [
          'ì²­ì£¼ì‹œ',
          'ì¶©ì£¼ì‹œ',
          'ì œì²œì‹œ',
          'ë³´ì€êµ°',
          'ì˜¥ì²œêµ°',
          'ì˜ë™êµ°',
          'ì¦í‰êµ°',
          'ì§„ì²œêµ°',
          'ê´´ì‚°êµ°',
          'ìŒì„±êµ°',
          'ë‹¨ì–‘êµ°',
        ],
        ì¶©ë‚¨: [
          'ì²œì•ˆì‹œ',
          'ê³µì£¼ì‹œ',
          'ë³´ë ¹ì‹œ',
          'ì•„ì‚°ì‹œ',
          'ì„œì‚°ì‹œ',
          'ë…¼ì‚°ì‹œ',
          'ê³„ë£¡ì‹œ',
          'ë‹¹ì§„ì‹œ',
          'ê¸ˆì‚°êµ°',
          'ë¶€ì—¬êµ°',
          'ì„œì²œêµ°',
          'ì²­ì–‘êµ°',
          'í™ì„±êµ°',
          'ì˜ˆì‚°êµ°',
          'íƒœì•ˆêµ°',
        ],
        ì „ë¶: [
          'ì „ì£¼ì‹œ',
          'êµ°ì‚°ì‹œ',
          'ìµì‚°ì‹œ',
          'ì •ìì‹œ',
          'ë‚¨ì›ì‹œ',
          'ê¹€ì œì‹œ',
          'ì™„ì£¼êµ°',
          'ì§„ì•ˆêµ°',
          'ë¬´ì£¼êµ°',
          'ì¥ìˆ˜êµ°',
          'ì„ì‹¤êµ°',
          'ìˆœì°½êµ°',
          'ê³ ì°½êµ°',
          'ë¶€ì•ˆêµ°',
        ],
        ì „ë‚¨: [
          'ëª©í¬ì‹œ',
          'ì—¬ìˆ˜ì‹œ',
          'ìˆœì²œì‹œ',
          'ë‚˜ì£¼ì‹œ',
          'ê´‘ì–‘ì‹œ',
          'ë‹´ì–‘êµ°',
          'ê³¡ì„±êµ°',
          'êµ¬ë¡€êµ°',
          'ê³ í¥êµ°',
          'ë³´ì„±êµ°',
          'í™”ìˆœêµ°',
          'ì¥í¥êµ°',
          'ê°•ì§„êµ°',
          'í•´ë‚¨êµ°',
          'ì˜ì•”êµ°',
          'ë¬´ì•ˆêµ°',
          'í•¨í‰êµ°',
          'ì˜ê´‘êµ°',
          'ì¥ì„±êµ°',
          'ì™„ë„êµ°',
          'ì§„ë„êµ°',
          'ì‹ ì•ˆêµ°',
        ],
        ê²½ë¶: [
          'í¬í•­ì‹œ',
          'ê²½ì£¼ì‹œ',
          'ê¹€ì²œì‹œ',
          'ì•ˆë™ì‹œ',
          'êµ¬ë¯¸ì‹œ',
          'ì˜ì£¼ì‹œ',
          'ì˜ì²œì‹œ',
          'ìƒì£¼ì‹œ',
          'ë¬¸ê²½ì‹œ',
          'ê²½ì‚°ì‹œ',
          'êµ°ìœ„êµ°',
          'ì˜ì„±êµ°',
          'ì²­ì†¡êµ°',
          'ì˜ì–‘êµ°',
          'ì˜ë•êµ°',
          'ì²­ë„êµ°',
          'ê³ ë ¹êµ°',
          'ì„±ì£¼êµ°',
          'ì¹ ê³¡êµ°',
          'ì˜ˆì²œêµ°',
          'ë´‰í™”êµ°',
          'ìš¸ì§„êµ°',
          'ìš¸ë¦‰êµ°',
        ],
        ê²½ë‚¨: [
          'ì°½ì›ì‹œ',
          'ì§„ì£¼ì‹œ',
          'í†µì˜ì‹œ',
          'ì‚¬ì²œì‹œ',
          'ê¹€í•´ì‹œ',
          'ë°€ì–‘ì‹œ',
          'ê±°ì œì‹œ',
          'ì–‘ì‚°ì‹œ',
          'ì˜ë ¹êµ°',
          'í•¨ì•ˆêµ°',
          'ì°½ë…•êµ°',
          'ê³ ì„±êµ°',
          'ë‚¨í•´êµ°',
          'í•˜ë™êµ°',
          'ì‚°ì²­êµ°',
          'í•¨ì–‘êµ°',
          'ê±°ì°½êµ°',
          'í•©ì²œêµ°',
        ],
        ì œì£¼: ['ì œì£¼ì‹œ', 'ì„œê·€í¬ì‹œ'],
      };

      // ì§€ì—­ ì„ íƒ ì‹œ êµ¬/ì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
      function updateDistricts() {
        console.log('========================================');
        console.log('ğŸ¯ updateDistricts() í•¨ìˆ˜ í˜¸ì¶œë¨!');
        console.log('========================================');

        const regionSelect = document.getElementById('region');
        const districtSelect = document.getElementById('district');

        if (!regionSelect || !districtSelect) {
          console.error('âŒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
          return;
        }

        const selectedRegion = regionSelect.value;
        console.log('ğŸ“ ì„ íƒëœ ì§€ì—­:', selectedRegion);

        // êµ¬/ì‹œ ì´ˆê¸°í™”
        districtSelect.innerHTML =
          '<option value="">êµ¬/ì‹œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';

        if (!selectedRegion) {
          districtSelect.style.opacity = '0.5';
          console.log('â¹ ì§€ì—­ì´ ì„ íƒë˜ì§€ ì•ŠìŒ - êµ¬/ì‹œ ë¹„í™œì„±í™”');
          return;
        }

        if (districtData[selectedRegion]) {
          const districts = districtData[selectedRegion];
          console.log(
            'âœ… ' + selectedRegion + ' ë°ì´í„°:',
            districts.length + 'ê°œ êµ¬/ì‹œ'
          );
          console.log('ì²« 5ê°œ:', districts.slice(0, 5));

          // êµ¬/ì‹œ ì˜µì…˜ ì¶”ê°€
          for (let i = 0; i < districts.length; i++) {
            const district = districts[i];
            const option = document.createElement('option');
            option.value = district;
            option.textContent = district;
            districtSelect.appendChild(option);
          }

          // ë“œë¡­ë‹¤ìš´ í™œì„±í™”
          districtSelect.style.opacity = '1';
          districtSelect.style.cursor = 'pointer';

          console.log('âœ… ë“œë¡­ë‹¤ìš´ í™œì„±í™” ì™„ë£Œ!');
          console.log('ì´ ì˜µì…˜ ìˆ˜:', districtSelect.options.length);
          console.log('========================================');

          // ì„±ê³µ ì•Œë¦¼ í† ìŠ¤íŠ¸
          const toast = document.createElement('div');
          toast.style.cssText =
            'position: fixed; top: 80px; right: 20px; background: #28a745; color: white; padding: 15px 20px; border-radius: 8px; z-index: 9999; box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-weight: 600;';
          toast.textContent =
            'âœ… ' +
            selectedRegion +
            ' - ' +
            districts.length +
            'ê°œ êµ¬/ì‹œ ë¡œë“œë¨';
          document.body.appendChild(toast);
          setTimeout(function () {
            toast.remove();
          }, 2000);
        } else {
          console.error('âŒ ' + selectedRegion + ' ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
          districtSelect.style.opacity = '0.5';
        }
      }

      // í˜ì´ì§€ ë¡œë“œ í›„ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
      window.testDistrict = function () {
        const districtSelect = document.getElementById('district');
        console.log('=== í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
        console.log('districtSelect:', districtSelect);
        console.log('disabled:', districtSelect.disabled);
        console.log('ì˜µì…˜ ìˆ˜:', districtSelect.options.length);
        console.log('style:', districtSelect.style.cssText);

        // ì„œìš¸ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
        districtSelect.innerHTML =
          '<option value="">êµ¬/ì‹œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
        const testData = ['ê°•ë‚¨êµ¬', 'ê°•ë™êµ¬', 'ê°•ë¶êµ¬', 'ê°•ì„œêµ¬', 'ê´€ì•…êµ¬'];
        testData.forEach(function (district) {
          const option = document.createElement('option');
          option.value = district;
          option.textContent = district;
          districtSelect.appendChild(option);
        });

        // ê°•ì œë¡œ í™œì„±í™”
        districtSelect.disabled = false;
        districtSelect.removeAttribute('disabled');
        districtSelect.style.opacity = '1';
        districtSelect.style.pointerEvents = 'auto';
        districtSelect.style.cursor = 'pointer';
        districtSelect.style.backgroundColor = '#fff';

        alert(
          'í…ŒìŠ¤íŠ¸: êµ¬/ì‹œ ë“œë¡­ë‹¤ìš´ì— 5ê°œ ì˜µì…˜ ì¶”ê°€í•˜ê³  í™œì„±í™” ì™„ë£Œ!\nì´ì œ í´ë¦­í•´ë³´ì„¸ìš”!'
        );
      };

      // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° í•¨ìˆ˜
      function previewImage() {
        const imageUrl = document.getElementById('image').value.trim();
        const previewContainer = document.getElementById(
          'imagePreviewContainer'
        );
        const previewImg = document.getElementById('previewImage');

        if (!imageUrl) {
          alert('ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”.');
          return;
        }

        previewImg.src = imageUrl;
        previewContainer.classList.add('show');

        previewImg.onerror = function () {
          alert('ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. URLì„ í™•ì¸í•˜ì„¸ìš”.');
          previewContainer.classList.remove('show');
        };

        previewImg.onload = function () {
          alert('ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.');
        };
      }

      // íƒ­ ì „í™˜
      function showTab(tabName) {
        // ëª¨ë“  íƒ­ ìˆ¨ê¸°ê¸°
        document.querySelectorAll('.tab-content').forEach((tab) => {
          tab.classList.remove('active');
        });
        document.querySelectorAll('.tab-btn').forEach((btn) => {
          btn.classList.remove('active');
        });

        // ì„ íƒëœ íƒ­ ë³´ì´ê¸°
        document.getElementById(tabName + '-tab').classList.add('active');
        event.target.classList.add('active');

        // íƒ­ë³„ ë°ì´í„° ë¡œë“œ
        if (tabName === 'list') {
          loadShopsList();
        } else if (tabName === 'stats') {
          loadStats();
        }
      }

      // ì½”ìŠ¤ ì¶”ê°€
      function addCourse() {
        courseCount++;
        const container = document.getElementById('coursesContainer');
        const courseDiv = document.createElement('div');
        courseDiv.className = 'course-item';
        courseDiv.innerHTML = `
          <div class="course-header">
            <h4>ì½”ìŠ¤ ${courseCount}</h4>
            <button type="button" class="remove-btn" onclick="removeCourse(this)">ì‚­ì œ</button>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>ì¹´í…Œê³ ë¦¬</label>
              <input type="text" name="courseCategory" placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ í”„ë¡œê·¸ë¨">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>ì½”ìŠ¤ëª…</label>
              <input type="text" name="courseName" placeholder="ì˜ˆ: Aì½”ìŠ¤">
            </div>
            <div class="form-group">
              <label>ê°€ê²©</label>
              <input type="text" name="coursePrice" placeholder="ì˜ˆ: 80,000ì›">
            </div>
            <div class="form-group">
              <label>ì‹œê°„</label>
              <input type="text" name="courseDuration" placeholder="ì˜ˆ: 60ë¶„">
            </div>
          </div>
          <div class="form-group">
            <label>ì„¤ëª…</label>
            <input type="text" name="courseDescription" placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ + ì•„ë¡œë§ˆ">
          </div>
        `;
        container.appendChild(courseDiv);

        // ì½”ìŠ¤ ì¶”ê°€ ì™„ë£Œ ì•Œë¦¼
        const btn = event.target;
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> ì¶”ê°€ë¨';
        btn.disabled = true;

        setTimeout(() => {
          btn.innerHTML = originalText;
          btn.disabled = false;
        }, 1000);
      }

      // ì½”ìŠ¤ ì‚­ì œ
      function removeCourse(button) {
        button.closest('.course-item').remove();
      }

      // í¼ ì œì¶œ
      document
        .getElementById('shopForm')
        .addEventListener('submit', function (e) {
          e.preventDefault();

          const formData = new FormData(this);
          const shopData = {};

          // ê¸°ë³¸ ì •ë³´
          for (let [key, value] of formData.entries()) {
            if (key.startsWith('course')) return; // ì½”ìŠ¤ ì •ë³´ëŠ” ë³„ë„ ì²˜ë¦¬
            shopData[key] = value;
          }

          // ë°°ì—´ í•„ë“œ ì²˜ë¦¬
          shopData.services = shopData.services
            ? shopData.services.split(',').map((s) => s.trim())
            : [];
          shopData.features = shopData.features
            ? shopData.features.split(',').map((s) => s.trim())
            : [];
          shopData.tags = shopData.tags
            ? shopData.tags.split(',').map((s) => s.trim())
            : [];

          // ì¢Œí‘œ ì²˜ë¦¬
          if (shopData.latitude && shopData.longitude) {
            shopData.coordinates = {
              latitude: parseFloat(shopData.latitude),
              longitude: parseFloat(shopData.longitude),
            };
            delete shopData.latitude;
            delete shopData.longitude;
          }

          // ì½”ìŠ¤ ì •ë³´ ìˆ˜ì§‘
          const courses = [];
          const courseItems = document.querySelectorAll('.course-item');
          courseItems.forEach((item) => {
            const category = item.querySelector(
              'input[name="courseCategory"]'
            ).value;
            const name = item.querySelector('input[name="courseName"]').value;
            const price = item.querySelector('input[name="coursePrice"]').value;
            const duration = item.querySelector(
              'input[name="courseDuration"]'
            ).value;
            const description = item.querySelector(
              'input[name="courseDescription"]'
            ).value;

            if (name && price && duration) {
              const existingCategory = courses.find(
                (c) => c.category === category
              );
              if (existingCategory) {
                existingCategory.items.push({
                  name,
                  price,
                  duration,
                  description,
                });
              } else {
                courses.push({
                  category: category || 'ê¸°ë³¸ ì½”ìŠ¤',
                  items: [{ name, price, duration, description }],
                });
              }
            }
          });

          shopData.courses = courses;

          try {
            shopManager.validateShopData(shopData);
            const addedShop = shopManager.addShop(shopData);
            alert('ì—…ì²´ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            this.reset();
            courseCount = 1;
            document.getElementById('coursesContainer').innerHTML = `
                    <div class="course-item">
                        <div class="course-header">
                            <h4>ì½”ìŠ¤ 1</h4>
                            <button type="button" class="remove-btn" onclick="removeCourse(this)">ì‚­ì œ</button>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>ì¹´í…Œê³ ë¦¬</label>
                                <input type="text" name="courseCategory" placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ í”„ë¡œê·¸ë¨">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>ì½”ìŠ¤ëª…</label>
                                <input type="text" name="courseName" placeholder="ì˜ˆ: Aì½”ìŠ¤">
                            </div>
                            <div class="form-group">
                                <label>ê°€ê²©</label>
                                <input type="text" name="coursePrice" placeholder="ì˜ˆ: 80,000ì›">
                            </div>
                            <div class="form-group">
                                <label>ì‹œê°„</label>
                                <input type="text" name="courseDuration" placeholder="ì˜ˆ: 60ë¶„">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>ì„¤ëª…</label>
                            <input type="text" name="courseDescription" placeholder="ì˜ˆ: ìŠ¤ì›¨ë””ì‹œ + ì•„ë¡œë§ˆ">
                        </div>
                    </div>
                `;
          } catch (error) {
            alert('ì˜¤ë¥˜: ' + error.message);
          }
        });

      // ì—…ì²´ ëª©ë¡ ë¡œë“œ
      function loadShopsList() {
        const shopsList = document.getElementById('shopsList');
        const shops = shopManager.shops;

        if (shops.length === 0) {
          shopsList.innerHTML = '<p>ë“±ë¡ëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
          return;
        }

        shopsList.innerHTML = shops
          .map(
            (shop) => `
                <div class="shop-card">
                    <div class="shop-header">
                        <div>
                            <h3>${shop.name}</h3>
                            <p>${shop.region} ${shop.district} | ${
              shop.type
            }</p>
                        </div>
                        <div>
                            <span class="status-badge status-${shop.status}">${
              shop.status === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'
            }</span>
                        </div>
                    </div>
                    <p><strong>ì£¼ì†Œ:</strong> ${shop.address}</p>
                    <p><strong>ì „í™”:</strong> ${shop.phone}</p>
                    <p><strong>ê°€ê²©:</strong> ${shop.price}</p>
                    <p><strong>í‰ì :</strong> ${shop.rating}/5 (${
              shop.reviewCount
            }ê°œ ë¦¬ë·°)</p>
                    <div class="shop-actions">
                        <button class="btn btn-primary" onclick="editShop('${
                          shop.id
                        }')">ìˆ˜ì •</button>
                        <button class="btn btn-danger" onclick="deleteShop('${
                          shop.id
                        }')">ì‚­ì œ</button>
                    </div>
                </div>
            `
          )
          .join('');
      }

      // í†µê³„ ë¡œë“œ
      function loadStats() {
        const statsInfo = document.getElementById('statsInfo');
        const stats = shopManager.getStatistics();

        statsInfo.innerHTML = `
                <div class="form-row">
                    <div class="form-group">
                        <h3>ì´ ì—…ì²´ ìˆ˜</h3>
                        <p style="font-size: 2rem; color: #667eea; margin: 0;">${
                          stats.totalShops
                        }</p>
                    </div>
                    <div class="form-group">
                        <h3>ì§€ì—­ ìˆ˜</h3>
                        <p style="font-size: 2rem; color: #667eea; margin: 0;">${
                          stats.regions
                        }</p>
                    </div>
                    <div class="form-group">
                        <h3>ì—…ì²´ ìœ í˜• ìˆ˜</h3>
                        <p style="font-size: 2rem; color: #667eea; margin: 0;">${
                          stats.types
                        }</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <h3>í‰ê·  í‰ì </h3>
                        <p style="font-size: 2rem; color: #667eea; margin: 0;">${
                          stats.averageRating
                        }</p>
                    </div>
                    <div class="form-group">
                        <h3>ì´ ë¦¬ë·° ìˆ˜</h3>
                        <p style="font-size: 2rem; color: #667eea; margin: 0;">${
                          stats.totalReviews
                        }</p>
                    </div>
                    <div class="form-group">
                        <h3>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</h3>
                        <p style="font-size: 1rem; color: #666; margin: 0;">${new Date(
                          stats.lastUpdated
                        ).toLocaleString()}</p>
                    </div>
                </div>
            `;
      }

      // ì—…ì²´ ìˆ˜ì •
      function editShop(shopId) {
        alert('ì—…ì²´ ìˆ˜ì • ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
      }

      // ì—…ì²´ ì‚­ì œ
      function deleteShop(shopId) {
        if (confirm('ì •ë§ë¡œ ì´ ì—…ì²´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          try {
            shopManager.deleteShop(shopId);
            loadShopsList();
            alert('ì—…ì²´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
          } catch (error) {
            alert('ì˜¤ë¥˜: ' + error.message);
          }
        }
      }

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
      document.addEventListener('DOMContentLoaded', function () {
        console.log('ğŸš€ í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ');

        // ì—…ì²´ ê´€ë¦¬ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        shopManager.loadShops().then(() => {
          console.log('âœ… ì—…ì²´ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
        });

        // === ì§€ì—­/êµ¬ì‹œ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ===
        console.log('ğŸ”§ ì§€ì—­/êµ¬ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì‹œì‘');

        const regionSelect = document.getElementById('region');
        const districtSelect = document.getElementById('district');

        console.log('regionSelect ìš”ì†Œ:', regionSelect);
        console.log('districtSelect ìš”ì†Œ:', districtSelect);

        if (regionSelect && districtSelect) {
          // change ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
          regionSelect.addEventListener('change', function () {
            console.log('ğŸ¯ ì§€ì—­ change ì´ë²¤íŠ¸ ë°œìƒ!');
            console.log('ì„ íƒëœ ê°’:', this.value);
            updateDistricts();
          });

          // í…ŒìŠ¤íŠ¸: í´ë¦­ ì´ë²¤íŠ¸ë„ ë“±ë¡
          regionSelect.addEventListener('click', function () {
            console.log('ğŸ–±ï¸ ì§€ì—­ í´ë¦­ë¨');
          });

          console.log('âœ… ì§€ì—­/êµ¬ì‹œ ì„ íƒ ì´ë²¤íŠ¸ ë“±ë¡ ì™„ë£Œ');
        } else {
          console.error('âŒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
          console.error('regionSelect:', regionSelect);
          console.error('districtSelect:', districtSelect);
        }

        // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
        const imageInput = document.getElementById('image');
        if (imageInput) {
          imageInput.addEventListener('input', function () {
            const imageUrl = this.value.trim();
            const previewContainer = document.getElementById(
              'imagePreviewContainer'
            );
            const previewImg = document.getElementById('previewImage');

            if (
              imageUrl &&
              (imageUrl.startsWith('http://') ||
                imageUrl.startsWith('https://'))
            ) {
              previewImg.src = imageUrl;
              previewContainer.classList.add('show');
              previewImg.onerror = function () {
                previewContainer.classList.remove('show');
              };
            } else {
              previewContainer.classList.remove('show');
            }
          });
        }
      });
    </script>
  </body>
</html>
